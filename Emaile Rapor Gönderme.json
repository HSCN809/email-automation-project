{
  "name": "Emaile Rapor GÃ¶nderme",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "minutes",
              "minutesInterval": 1
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        0,
        0
      ],
      "id": "584d2d2a-72e6-4e14-87b1-a7bdad1888dc",
      "name": "Schedule Trigger"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1S9oXpl4hd0Np76znssgzIYTFzA4PHKtAkzERoPMR-SE",
          "mode": "list",
          "cachedResultName": "Linke TÄ±klanma Log KayÄ±tlarÄ±",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1S9oXpl4hd0Np76znssgzIYTFzA4PHKtAkzERoPMR-SE/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Sayfa1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1S9oXpl4hd0Np76znssgzIYTFzA4PHKtAkzERoPMR-SE/edit#gid=0"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        220,
        0
      ],
      "id": "029147b3-007d-4419-96e5-38b6af6a6546",
      "name": "Get row(s) in sheet",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "izP7qp7f31YDuRmV",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const items = $input.all();\n\n// Segment bazlÄ± toplam tÄ±klama iÃ§in tanÄ±m\nconst segmentClicks = {};\n\n// Kampanya + kacÄ±ncÄ±_email bazlÄ± detaylÄ± istatistik\nconst emailStats = {};\n\nfor (const item of items) {\n  const campaign = item.json.campaign || 'Bilinmeyen Kampanya';\n  const emailNo = item.json.kacÄ±ncÄ±_email || 'Bilinmeyen Email No';\n\n  // Toplam segment tÄ±klamasÄ±\n  if (!segmentClicks[campaign]) {\n    segmentClicks[campaign] = 0;\n  }\n  segmentClicks[campaign]++;\n\n  // Email No bazlÄ± detaylÄ± istatistik\n  if (!emailStats[campaign]) {\n    emailStats[campaign] = {};\n  }\n  if (!emailStats[campaign][emailNo]) {\n    emailStats[campaign][emailNo] = 0;\n  }\n  emailStats[campaign][emailNo]++;\n}\n\n// HTML oluÅŸtur\nlet html = `\n  <h2>ðŸ“Š Email TÄ±klama Raporu</h2>\n  <p>Toplam kampanya ve gÃ¶nderilen email tÄ±klamalarÄ± aÅŸaÄŸÄ±da listelenmiÅŸtir.</p>\n\n  <h3 style=\"margin-top: 20px;\">ðŸ”— Kampanya & GÃ¶nderilen Email BazlÄ± Detay</h3>\n  <table border=\"1\" cellpadding=\"6\" cellspacing=\"0\" style=\"border-collapse: collapse; margin-bottom: 30px;\">\n    <thead style=\"background-color: #f2f2f2;\">\n      <tr>\n        <th>Kampanya</th>\n        <th>KaÃ§Ä±ncÄ± Email GÃ¶nderildi?</th>\n        <th>TÄ±klama SayÄ±sÄ±</th>\n      </tr>\n    </thead>\n    <tbody>\n`;\n\nfor (const campaign in emailStats) {\n  for (const emailNo in emailStats[campaign]) {\n    html += `\n      <tr>\n        <td>${campaign}</td>\n        <td>${emailNo}</td>\n        <td>${emailStats[campaign][emailNo]}</td>\n      </tr>\n    `;\n  }\n}\n\nhtml += `\n    </tbody>\n  </table>\n\n  <h3 style=\"margin-top: 20px;\">ðŸ“Œ Segment BazlÄ± Toplam TÄ±klama</h3>\n  <table border=\"1\" cellpadding=\"6\" cellspacing=\"0\" style=\"border-collapse: collapse;\">\n    <thead style=\"background-color: #f9f9f9;\">\n      <tr>\n        <th>Segment</th>\n        <th>Segment BaÅŸÄ±na Toplam TÄ±klanma</th>\n      </tr>\n    </thead>\n    <tbody>\n`;\n\nfor (const segment in segmentClicks) {\n  html += `\n    <tr>\n      <td>${segment}</td>\n      <td>${segmentClicks[segment]}</td>\n    </tr>\n  `;\n}\n\nhtml += `\n    </tbody>\n  </table>\n\n  <p style=\"margin-top: 20px; font-style: italic;\">HazÄ±rlayan: n8n Otomasyon Sistemi</p>\n`;\n\nreturn [{ json: { html } }];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        440,
        0
      ],
      "id": "1fe26f1f-f572-4c8c-8b95-11327dc2f9df",
      "name": "Code"
    },
    {
      "parameters": {
        "sendTo": "ozenhuseyinberat15@gmail.com",
        "subject": "ðŸ“ˆ HaftalÄ±k Email Performans Raporu",
        "message": "=<html>\n  <body style=\"font-family: Arial, sans-serif; color: #333;\">\n    <h2 style=\"color: #2E86C1;\">ðŸ“Š HaftalÄ±k Email Performans Ã–zeti</h2>\n\n    <p>Merhaba,</p>\n\n    <p>\n      <strong>{{ $now.minus({ days: 7 }).toFormat('dd.MM.yyyy') }}</strong> -\n      <strong>{{ $now.toFormat('dd.MM.yyyy') }}</strong> tarihleri arasÄ±ndaki\n      email tÄ±klama verileri aÅŸaÄŸÄ±daki tabloda Ã¶zetlenmiÅŸtir:\n    </p>\n\n    <hr>\n\n    {{ $json[\"html\"] }}\n\n    <hr>\n\n    <p>ðŸ“Œ Bu veriler, kullanÄ±cÄ±larÄ±n hangi mesajlara daha Ã§ok ilgi gÃ¶sterdiÄŸini\n    analiz etmenize yardÄ±mcÄ± olabilir.</p>\n\n    <p style=\"font-size: 14px; color: #888;\">\n      Rapor oluÅŸturulma zamanÄ±: {{ $now.toFormat('dd.MM.yyyy HH:mm') }}\n    </p>\n\n    <p>Sevgiler,<br><strong>Otomasyon Sisteminiz ðŸ¤–</strong></p>\n  </body>\n</html>",
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        660,
        0
      ],
      "id": "619864e1-7d0e-4362-8002-ec79cab499f5",
      "name": "Send a message",
      "webhookId": "81d2b920-af39-44e8-b42c-23d31fad3880",
      "credentials": {
        "gmailOAuth2": {
          "id": "BTQVjvOGiE0L5Qk9",
          "name": "Gmail account"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "Schedule Trigger": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet": {
      "main": [
        [
          {
            "node": "Code",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code": {
      "main": [
        [
          {
            "node": "Send a message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "46287868-28d2-4b35-aa62-f0bd45e7eaf7",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "4f0975136b9e27ed96582e7766048a49bf45bf914fd93bb2a32b49bf4a4e21b5"
  },
  "id": "xSRz326kYPy1SFMJ",
  "tags": []
}